<?xml version="1.0" encoding="ISO-8859-1"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

  <modelVersion>4.0.0</modelVersion>

  <parent>
    <groupId>org.geoserver</groupId>
    <artifactId>extension</artifactId>
    <version>2.12-SNAPSHOT</version>
  </parent>

  <groupId>org.geoserver.extension</groupId>
  <artifactId>gs-libjpeg-turbo</artifactId>
  <packaging>jar</packaging>
  <version>2.12-SNAPSHOT</version>
  <name>GeoServer libjpeg-turbo Module</name>

  <dependencies>
    <dependency>
      <groupId>org.geotools</groupId>
      <artifactId>gt-sample-data</artifactId>
      <version>${gt.version}</version>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>it.geosolutions.imageio-ext</groupId>
      <artifactId>imageio-ext-turbojpeg</artifactId>
    </dependency>

    <!-- test dependencies -->
    <dependency>
      <groupId>xmlunit</groupId>
      <artifactId>xmlunit</artifactId>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-test</artifactId>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.geoserver</groupId>
      <artifactId>gs-main</artifactId>
      <version>${project.version}</version>
      <classifier>tests</classifier>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.geoserver</groupId>
      <artifactId>gs-wms</artifactId>
      <version>${project.version}</version>
    </dependency>
    <dependency>
      <groupId>org.geoserver</groupId>
      <artifactId>gs-wms</artifactId>
      <version>${project.version}</version>
      <classifier>tests</classifier>
      <scope>test</scope>
    </dependency>

  </dependencies>

  <profiles>
    <profile>
      <id>testWithNativeJaiExt</id>
      <build>
        <plugins>
          <plugin>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.12.3</version>
            <configuration>
              <runOrder>alphabetical</runOrder>
              <source>1.8</source>
              <target>1.8</target>
              <includes>
                <include>**/*Test.java</include>
              </includes>
              <excludes>
                <exclude>${test.exclude.pattern}</exclude>
              </excludes>
              <forkMode>once</forkMode>
              <argLine>-Djava.library.path=/opt/libjpeg-turbo/lib64:/usr/lib/jni -Xmx${test.maxHeapSize}
                -enableassertions ${jvm.opts} -Djava.awt.headless=${java.awt.headless}
                -Dsun.java2d.d3d=${sun.java2d.d3d} -DremoteOwsTests=${remoteOwsTests} -DquietTests=${quietTests}
                -Dorg.geotools.image.test.enabled=${image.tests}
                -Dorg.geotools.image.test.interactive=${interactive.image} -Duser.timezone=${user.timezone}
                -Dwindows.leniency=${windows.leniency} -XX:+TieredCompilation -XX:TieredStopAtLevel=1
              </argLine>
              <enableAssertions>true</enableAssertions>
              <printSummary>true</printSummary>
              <testFailureIgnore>${allow.test.failure.ignore}</testFailureIgnore>
              <excludedGroups>${test.excludedGroups}</excludedGroups>
              <additionalClasspathElements>
                <additionalClasspathElement>/usr/share/java/mlibwrapper_jai.jar</additionalClasspathElement>
                <additionalClasspathElement>/usr/share/java/jai_codec.jar</additionalClasspathElement>
                <additionalClasspathElement>/usr/share/java/jai_core.jar</additionalClasspathElement>
                <additionalClasspathElement>/usr/share/java/clibwrapper_jiio.jar</additionalClasspathElement>
                <additionalClasspathElement>/usr/share/java/jai_imageio.jar</additionalClasspathElement>
              </additionalClasspathElements>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
  </profiles>
</project>
